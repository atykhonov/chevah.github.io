

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Bash &mdash; Chevah Style Guide  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="Chevah Style Guide  documentation" href="index.html"/>
        <link rel="next" title="References" href="references.html"/>
        <link rel="prev" title="HTML, XML and other markups" href="html.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Chevah Style Guide
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="generic.html">Generic</a></li>
<li class="toctree-l1"><a class="reference internal" href="testing.html">Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="review.html">Review</a></li>
<li class="toctree-l1"><a class="reference internal" href="defects-tech-debt.html">Bugs and Tech-Debt</a></li>
<li class="toctree-l1"><a class="reference internal" href="leave.html">Leave / Holiday</a></li>
<li class="toctree-l1"><a class="reference internal" href="library.html">Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="release.html">Release process</a></li>
<li class="toctree-l1"><a class="reference internal" href="work.html">Work</a></li>
<li class="toctree-l1"><a class="reference internal" href="python.html">Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="javascript.html">JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="css.html">CSS, LESS and Styles</a></li>
<li class="toctree-l1"><a class="reference internal" href="html.html">HTML, XML and other markups</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Bash</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="#path-constants">Path constants</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-definition">Function Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#case-syntax">Case Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="#if-then-else">IF/THEN/ELSE</a></li>
<li class="toctree-l2"><a class="reference internal" href="#for">FOR</a></li>
<li class="toctree-l2"><a class="reference internal" href="#while-until">WHILE/UNTIL</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Chevah Style Guide</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Bash</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/bash.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="bash">
<h1><a class="toc-backref" href="#id1">Bash</a><a class="headerlink" href="#bash" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#bash" id="id1">Bash</a><ul>
<li><a class="reference internal" href="#general" id="id2">General</a></li>
<li><a class="reference internal" href="#path-constants" id="id3">Path constants</a></li>
<li><a class="reference internal" href="#function-definition" id="id4">Function Definition</a></li>
<li><a class="reference internal" href="#case-syntax" id="id5">Case Syntax</a></li>
<li><a class="reference internal" href="#if-then-else" id="id6">IF/THEN/ELSE</a></li>
<li><a class="reference internal" href="#for" id="id7">FOR</a></li>
<li><a class="reference internal" href="#while-until" id="id8">WHILE/UNTIL</a></li>
<li><a class="reference internal" href="#references" id="id9">References</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="general">
<h2><a class="toc-backref" href="#id2">General</a><a class="headerlink" href="#general" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Shell scripts should be kept at a minimum and <strong>only</strong> for internal scripts.
For all other things there is Python.</li>
<li>If any, public scripts should use <code class="docutils literal"><span class="pre">/bin/sh</span></code>. Bash is not available on all
Unix systems and ksh or other shells are not compatible with Bash syntax.</li>
<li>Use <code class="docutils literal"><span class="pre">printf</span></code> instead of <code class="docutils literal"><span class="pre">echo</span></code> when using  <code class="docutils literal"><span class="pre">/bin/sh</span></code> as a shell,
because <code class="docutils literal"><span class="pre">echo</span></code> behaviour is incompatible in Bash and Korn shells.
Eg. use <code class="docutils literal"><span class="pre">printf</span></code> instead of <code class="docutils literal"><span class="pre">echo</span> <span class="pre">-n</span></code> and <code class="docutils literal"><span class="pre">printf</span> <span class="pre">&quot;blabla\n&quot;</span></code> instead
of <code class="docutils literal"><span class="pre">echo</span> <span class="pre">&quot;blabla&quot;</span></code>.</li>
<li>For internal scripts we should use <code class="docutils literal"><span class="pre">/bin/bash</span></code>, as the default <code class="docutils literal"><span class="pre">/bin/sh</span></code>
sometimes points to a lesser shell such as Dash.</li>
<li>A function called main is required for scripts long enough to contain at
least one other function.</li>
<li>Put all functions together in the file just below constants. Don&#8217;t hide
executable code between functions.</li>
<li>Use uppercase for all GLOBAL variables.</li>
<li>In tests, enclose all uncontrolled string variables in double quotes to
handle empty strings or spaces in variables.</li>
<li>Always double quote the <code class="docutils literal"><span class="pre">$&#64;</span></code> variable to keep all arguments with spaces.</li>
<li>Pipelines should be split one per line if they don&#8217;t all fit on one line.</li>
<li>Use $(command) instead of backticks. Nested backticks require escaping the
inner ones with . The $(command) format doesn&#8217;t change when nested and is
easier to read. See the example below</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1"># This is preferred:</span>
<span class="nv">var</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span><span class="nb">command</span> <span class="s2">&quot;</span><span class="k">$(</span>command1<span class="k">)</span><span class="s2">&quot;</span><span class="k">)</span><span class="s2">&quot;</span>

<span class="c1"># This is not:</span>
<span class="nv">var</span><span class="o">=</span><span class="s2">&quot;`command \`command1\``&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li>Always guard your Bash scripts from unexpected errors by using</li>
</ul>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nb">set</span> -o nounset
</pre></div>
</div>
</div>
<div class="section" id="path-constants">
<h2><a class="toc-backref" href="#id3">Path constants</a><a class="headerlink" href="#path-constants" title="Permalink to this headline">¶</a></h2>
<p>When defining a directory path as a constant, you should include the trailing
slash to make sure it is a directory and not a file. Two consecutive /&#8217;s are
harmless in POSIX shells as long as they are not at the beginning of the path
in some exotic environment such as Cygwin that actually uses this notation for
SMB shares.</p>
<p>Always double quote path constants to handle files with spaces:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">SOME_PATH</span><span class="o">=</span>/some/path/
<span class="c1"># and use it like this:</span>
<span class="nb">command</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">SOME_PATH</span><span class="si">}</span><span class="s2">/some.file&quot;</span>

<span class="c1"># Another example</span>
<span class="nv">REMOTE_URI</span><span class="o">=</span>chevah@chevah.com:/home/chevah/styleguide.chevah.com/vm/
scp <span class="s2">&quot;</span><span class="nv">$LOCAL_FILE</span><span class="s2">&quot;</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">REMOTE_URL</span><span class="si">}</span><span class="s2">/file&quot;</span>
</pre></div>
</div>
<p>Instead of:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="nv">SOME_PATH</span><span class="o">=</span>/some/path/
<span class="c1"># and then:</span>
<span class="nb">command</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">SOME_PATH</span><span class="si">}</span><span class="s2">some.file&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="function-definition">
<h2><a class="toc-backref" href="#id4">Function Definition</a><a class="headerlink" href="#function-definition" title="Permalink to this headline">¶</a></h2>
<p>Leave 2 blank lines between function definitions and always use <code class="docutils literal"><span class="pre">local</span></code> for
local variable declaration.</p>
<p>Define local variables at the start of the function, in a distinct block.
It is recommended to define a local variable named <cite>result</cite> to hold the value
produced by calling the function.</p>
<p>Put the final returned result in a separate block.</p>
<p>Procedures are functions which have no result.</p>
<p>Since Bash only support returning numeric values, which are interpreted
as exit codes, we will pass values between functions by using <code class="docutils literal"><span class="pre">echo</span></code>.</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="c1">#</span>
<span class="c1"># Description of function 1.</span>
<span class="c1">#</span>
<span class="c1"># * $1 - description of first argument</span>
<span class="c1"># * $2 - description of second argument</span>
<span class="c1"># * return - description of return value.</span>

function1<span class="o">()</span> <span class="o">{</span>
    <span class="nb">local</span> variable_which_is_local
    <span class="nb">local</span> result

    do_some_action_here
    do_more_action

    <span class="nb">echo</span> <span class="nv">$result</span>
<span class="o">}</span>


<span class="c1">#</span>
<span class="c1"># Description of procedure 1.</span>
<span class="c1">#</span>
<span class="c1"># It does this and this.</span>
<span class="c1">#</span>
procedure1<span class="o">()</span> <span class="o">{</span>
    <span class="nb">local</span> <span class="nv">something</span><span class="o">=</span><span class="k">$(</span>function1 ARG1<span class="k">)</span>

    do_something_else something
<span class="o">}</span>
</pre></div>
</div>
</div>
<div class="section" id="case-syntax">
<h2><a class="toc-backref" href="#id5">Case Syntax</a><a class="headerlink" href="#case-syntax" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="k">case</span> <span class="s2">&quot;</span><span class="nv">$VARIABLE_NAME</span><span class="s2">&quot;</span> in
    <span class="s2">&quot;option1&quot;</span><span class="o">)</span>
        <span class="k">do</span> specific
        <span class="p">;;</span>
    option2*<span class="o">)</span>
        <span class="k">do</span> generic
        <span class="p">;;</span>
    *<span class="o">)</span>
        <span class="k">do</span> default
        <span class="p">;;</span>
<span class="k">esac</span>
</pre></div>
</div>
</div>
<div class="section" id="if-then-else">
<h2><a class="toc-backref" href="#id6">IF/THEN/ELSE</a><a class="headerlink" href="#if-then-else" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="k">if</span> TEST<span class="p">;</span> <span class="k">then</span>
    call something
<span class="k">elif</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$string</span><span class="s2">&quot;</span> <span class="o">=</span> OTHER_TEST <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    call something_else
<span class="k">else</span>
    call something_else_completely
<span class="k">fi</span>
</pre></div>
</div>
</div>
<div class="section" id="for">
<h2><a class="toc-backref" href="#id7">FOR</a><a class="headerlink" href="#for" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="k">for</span> CONDITION<span class="p">;</span> <span class="k">do</span>
    call something
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="while-until">
<h2><a class="toc-backref" href="#id8">WHILE/UNTIL</a><a class="headerlink" href="#while-until" title="Permalink to this headline">¶</a></h2>
<div class="highlight-bash"><div class="highlight"><pre><span></span><span class="k">while</span> TEST<span class="p">;</span> <span class="k">do</span>
    call something
<span class="k">done</span>
</pre></div>
</div>
</div>
<div class="section" id="references">
<h2><a class="toc-backref" href="#id9">References</a><a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Here are the pages I used to create this page.</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference external" href="http://www.davidpashley.com/articles/writing-robust-shell-scripts/">http://www.davidpashley.com/articles/writing-robust-shell-scripts/</a></li>
<li><a class="reference external" href="http://www.linuxjournal.com/content/return-values-bash-functions">http://www.linuxjournal.com/content/return-values-bash-functions</a></li>
</ul>
</div></blockquote>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="references.html" class="btn btn-neutral float-right" title="References" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="html.html" class="btn btn-neutral" title="HTML, XML and other markups" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Chevah Team.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>